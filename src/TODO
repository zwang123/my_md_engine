use valarray instead of vector?
